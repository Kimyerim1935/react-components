import{j as v}from"./jsx-runtime-BjgbQsUx.js";import{r as t}from"./index-DDT2H6na.js";import{r as h}from"./index-DttxB2Wl.js";import{j as w}from"./format-BvyHdC65.js";const y='button, a, input, select, textarea, [tabindex]:not([tabindex="-1"])';function L(l){const{canFocusTrap:r,children:p,className:d,isDimmed:E,isOpen:n,onClose:u}=l,f=t.useRef(null);t.useEffect(()=>(n?document.body.style.overflow="hidden":document.body.style.removeProperty("overflow"),()=>{document.body.style.removeProperty("overflow")}),[n]),t.useEffect(()=>{var e;n&&r&&[...((e=f.current)==null?void 0:e.querySelectorAll(y))||[]].shift().focus()},[n,r]);const m=t.useCallback(e=>{var s;const a=((s=f.current)==null?void 0:s.querySelectorAll(y))||[],i=[...a].shift(),c=[...a].pop();if(e.code==="Escape")u();else if(e.code==="Tab"){const{activeElement:o}=document;e.shiftKey&&o===i?(e.preventDefault(),c==null||c.focus()):!e.shiftKey&&o===c&&(e.preventDefault(),i==null||i.focus())}},[u]);return t.useEffect(()=>(n&&r&&document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)),[m,n,r]),t.useEffect(()=>{if(!document.getElementById("portal")){const e=document.createElement("div");e.setAttribute("id","portal"),document.getElementsByTagName("body")[0].appendChild(e)}},[]),n?h.createPortal(v.jsx("div",{ref:f,onClick:u,role:"presentation",className:w("fixed bottom-0 left-0 right-0 top-0 z-10000",E&&"bg-black/10",d&&d),children:p}),document.getElementById("portal")):null}const B=300,C=24,T=20,N=({inputId:l,isVisible:r,listBoxId:p,totalLength:d})=>{const[E,n]=t.useState(0),[u,f]=t.useState(0),[m,e]=t.useState(1),[a,i]=t.useState(300),c=t.useCallback(()=>{const o=document.getElementById(l);return o?o.getBoundingClientRect().bottom+Math.min(B,d*C)+T>=window.innerHeight:!1},[l,d]),s=t.useCallback(()=>{const o=document.getElementById(l),g=document.getElementById(p);if(r&&o&&g){const b=o.getBoundingClientRect().top;c()?(n(b-g.offsetHeight),e(0)):(n(1),e(o.getBoundingClientRect().top+o.getBoundingClientRect().height-1)),f(o.getBoundingClientRect().x),i(o.getBoundingClientRect().width)}},[l,p,r,c]);return t.useEffect(()=>(s(),window.addEventListener("resize",s),window.addEventListener("scroll",s),()=>{window.removeEventListener("resize",s),window.removeEventListener("scroll",s)}),[s]),{handlePosition:s,isTop:c,left:u,marginTop:m,maxWidth:a,top:E}};export{L as B,N as u};
